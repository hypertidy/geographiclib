<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Access to GeographicLib • geographiclib</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Access to GeographicLib">
<meta property="og:description" content="GeographicLib functions, with MGRS, UTMUPS, and polygonarea.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">geographiclib</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hypertidy/geographiclib/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="geographiclib">geographiclib<a class="anchor" aria-label="anchor" href="#geographiclib"></a>
</h1></div>
<!-- badges: start -->

<p>The goal of geographiclib is to wrap the awesome <a href="https://geographiclib.sourceforge.io/" class="external-link">GeographicLib</a> library for precise geodetic calculations in R.</p>
<div class="section level2">
<h2 id="features">Features<a class="anchor" aria-label="anchor" href="#features"></a>
</h2>
<ul>
<li>
<strong>Fully vectorized MGRS conversion</strong> - Convert thousands of coordinates in milliseconds</li>
<li>
<strong>Fully vectorized UTM/UPS conversion</strong> - Direct access to Universal Transverse Mercator and Universal Polar Stereographic projections</li>
<li>
<strong>Geodesic calculations</strong> - Exact solutions for direct and inverse geodesic problems on the WGS84 ellipsoid”</li>
<li>
<strong>Geodesic polygon area</strong> - Accurate area and perimeter calculations on the WGS84 ellipsoid</li>
<li>
<strong>Rich output</strong> - Get projected coordinates, zones, convergence, scale factors, grid designators, and EPSG codes</li>
<li>
<strong>Variable precision support</strong> - Generate MGRS codes from 100km to 1m precision</li>
<li>
<strong>Polar region support</strong> - Handles UPS (Universal Polar Stereographic) zones automatically</li>
<li>
<strong>Fast C++ implementation</strong> - Built on GeographicLib’s battle-tested geodetic algorithms</li>
</ul>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of geographiclib like so:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"hypertidy/geographiclib"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="mgrs---military-grid-reference-system">MGRS - Military Grid Reference System<a class="anchor" aria-label="anchor" href="#mgrs---military-grid-reference-system"></a>
</h2>
<p>Convert coordinates to MGRS and back:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hypertidy/geographiclib" class="external-link">geographiclib</a></span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">code</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mgrs_fwd.html">mgrs_fwd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">147.325</span>, <span class="op">-</span><span class="fl">42.881</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "55GEN2654152348"</span></span>
<span><span class="fu"><a href="reference/mgrs_fwd.html">mgrs_rev</a></span><span class="op">(</span><span class="va">code</span><span class="op">)</span></span>
<span><span class="co">#&gt;       lon     lat        x       y zone northp precision convergence     scale</span></span>
<span><span class="co">#&gt; 1 147.325 -42.881 526541.5 5252348   55  FALSE         5  -0.2211584 0.9996087</span></span>
<span><span class="co">#&gt;   grid_zone square_100km        crs</span></span>
<span><span class="co">#&gt; 1       55G           EN EPSG:32755</span></span></code></pre></div>
<div class="section level3">
<h3 id="vectorized-forward-conversion">Vectorized forward conversion<a class="anchor" aria-label="anchor" href="#vectorized-forward-conversion"></a>
</h3>
<p>The <code><a href="reference/mgrs_fwd.html">mgrs_fwd()</a></code> function is fully vectorized on both coordinates and precision:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">6</span>, <span class="op">-</span><span class="fl">180</span>, <span class="fl">180</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">6</span>, <span class="op">-</span><span class="fl">90</span>, <span class="fl">90</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dput.html" class="external-link">dput</a></span><span class="op">(</span><span class="va">pts</span><span class="op">)</span></span>
<span><span class="co">#&gt; structure(c(-135.940789924935, 146.450087428093, -135.992219271138, </span></span>
<span><span class="co">#&gt; 98.8097724225372, -109.255064958706, -161.520988801494, -84.63214145042, </span></span>
<span><span class="co">#&gt; -63.0903754150495, -12.7286182204261, -84.0003408305347, 48.6669166339561, </span></span>
<span><span class="co">#&gt; 27.0200930396095), dim = c(6L, 2L))</span></span>
<span></span>
<span><span class="co"># Variable precision: from 100km (0) to 1m (5)</span></span>
<span><span class="fu"><a href="reference/mgrs_fwd.html">mgrs_fwd</a></span><span class="op">(</span><span class="va">pts</span>, precision <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "ATH"             "55EDL70"         "08LLL9292"       "BJL588978"      </span></span>
<span><span class="co">#&gt; [5] "12UXU28479189"   "04RBQ4987691161"</span></span>
<span></span>
<span><span class="co"># Different precisions for each point</span></span>
<span><span class="op">(</span><span class="va">code</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mgrs_fwd.html">mgrs_fwd</a></span><span class="op">(</span><span class="va">pts</span>, precision <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "ATH8527771429" "55EDL72230422" "08LLL922926"   "BJL5897"      </span></span>
<span><span class="co">#&gt; [5] "12UXU29"       "04RBQ"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="rich-reverse-conversion-output">Rich reverse conversion output<a class="anchor" aria-label="anchor" href="#rich-reverse-conversion-output"></a>
</h3>
<p>The <code><a href="reference/mgrs_fwd.html">mgrs_rev()</a></code> function returns a comprehensive data frame with 12 columns:</p>
<ul>
<li>
<strong>Geographic coordinates</strong> (<code>lon</code>/<code>lat</code> in decimal degrees)</li>
<li>
<strong>Projected coordinates</strong> (<code>x</code>/<code>y</code> in meters, UTM/UPS)</li>
<li>
<strong>Zone information</strong> (<code>zone</code> number, <code>northp</code> hemisphere, <code>grid_zone</code> designator, <code>square_100km</code> ID)</li>
<li>
<strong>Geodetic properties</strong> (<code>convergence</code> angle in degrees, <code>scale</code> factor)</li>
<li>
<strong>Precision level</strong> (0-5, decoded from MGRS string)</li>
<li>
<strong>CRS identification</strong> (<code>crs</code> as EPSG codes for direct use with spatial packages)</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/mgrs_fwd.html">mgrs_rev</a></span><span class="op">(</span><span class="va">code</span><span class="op">)</span></span>
<span><span class="co">#&gt;          lon       lat       x       y zone northp precision convergence</span></span>
<span><span class="co">#&gt; 1 -135.94079 -84.63214 1585278 1571430    0  FALSE         5 135.9407888</span></span>
<span><span class="co">#&gt; 2  146.45015 -63.09035  472235 3004225   55  FALSE         4   0.4903171</span></span>
<span><span class="co">#&gt; 3 -135.99251 -12.72879  392250 8592650    8  FALSE         3   0.2187079</span></span>
<span><span class="co">#&gt; 4   98.84748 -84.00268 2658500 1897500    0  FALSE         2 -98.8474781</span></span>
<span><span class="co">#&gt; 5 -109.30131  48.69551  625000 5395000   12   TRUE         1   1.2762439</span></span>
<span><span class="co">#&gt; 6 -161.51154  26.64883  250000 2950000    4   TRUE         0  -1.1270625</span></span>
<span><span class="co">#&gt;       scale grid_zone square_100km        crs</span></span>
<span><span class="co">#&gt; 1 0.9961843         A           TH EPSG:32761</span></span>
<span><span class="co">#&gt; 2 0.9996094       55E           DL EPSG:32755</span></span>
<span><span class="co">#&gt; 3 0.9997436       08L           LL EPSG:32708</span></span>
<span><span class="co">#&gt; 4 0.9967276         B           JL EPSG:32761</span></span>
<span><span class="co">#&gt; 5 0.9997920       12U           XU EPSG:32612</span></span>
<span><span class="co">#&gt; 6 1.0003717       04R           BQ EPSG:32604</span></span></code></pre></div>
<p>The reverse conversion returns the center point of each MGRS grid cell.</p>
</div>
</div>
<div class="section level2">
<h2 id="utmups---universal-transverse-mercator--universal-polar-stereographic">UTM/UPS - Universal Transverse Mercator / Universal Polar Stereographic<a class="anchor" aria-label="anchor" href="#utmups---universal-transverse-mercator--universal-polar-stereographic"></a>
</h2>
<p>Direct access to UTM/UPS projections for precise coordinate conversion:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Forward: Geographic to UTM/UPS</span></span>
<span><span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">147.325</span>, <span class="op">-</span><span class="fl">63.22</span>, <span class="fl">0</span>, <span class="fl">45.67</span><span class="op">)</span>,</span>
<span>             lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">42.881</span>, <span class="fl">17.62</span>, <span class="fl">88</span>, <span class="fl">39.84</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">utm</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/utmups_fwd.html">utmups_fwd</a></span><span class="op">(</span><span class="va">pts</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;           x       y zone northp convergence     scale     lon     lat</span></span>
<span><span class="co">#&gt; 1  526541.3 5252349   55  FALSE -0.22115661 0.9996087 147.325 -42.881</span></span>
<span><span class="co">#&gt; 2  476660.8 1948158   20   TRUE -0.06659487 0.9996067 -63.220  17.620</span></span>
<span><span class="co">#&gt; 3 2000000.0 1777931    0   TRUE  0.00000000 0.9943028   0.000  88.000</span></span>
<span><span class="co">#&gt; 4  557324.5 4410214   38   TRUE  0.42924443 0.9996405  45.670  39.840</span></span>
<span><span class="co">#&gt;          crs</span></span>
<span><span class="co">#&gt; 1 EPSG:32755</span></span>
<span><span class="co">#&gt; 2 EPSG:32620</span></span>
<span><span class="co">#&gt; 3 EPSG:32661</span></span>
<span><span class="co">#&gt; 4 EPSG:32638</span></span></code></pre></div>
<p>The forward conversion automatically selects the appropriate UTM zone (or UPS for polar regions) and returns:</p>
<ul>
<li>Projected coordinates (x/y in meters)</li>
<li>Zone and hemisphere information</li>
<li>Meridian convergence and scale factor</li>
<li>EPSG CRS codes</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Reverse: UTM/UPS to Geographic</span></span>
<span><span class="fu"><a href="reference/utmups_fwd.html">utmups_rev</a></span><span class="op">(</span><span class="va">utm</span><span class="op">$</span><span class="va">x</span>, <span class="va">utm</span><span class="op">$</span><span class="va">y</span>, <span class="va">utm</span><span class="op">$</span><span class="va">zone</span>, <span class="va">utm</span><span class="op">$</span><span class="va">northp</span><span class="op">)</span></span>
<span><span class="co">#&gt;       lon     lat         x       y zone northp convergence     scale</span></span>
<span><span class="co">#&gt; 1 147.325 -42.881  526541.3 5252349   55  FALSE -0.22115661 0.9996087</span></span>
<span><span class="co">#&gt; 2 -63.220  17.620  476660.8 1948158   20   TRUE -0.06659487 0.9996067</span></span>
<span><span class="co">#&gt; 3   0.000  88.000 2000000.0 1777931    0   TRUE  0.00000000 0.9943028</span></span>
<span><span class="co">#&gt; 4  45.670  39.840  557324.5 4410214   38   TRUE  0.42924443 0.9996405</span></span>
<span><span class="co">#&gt;          crs</span></span>
<span><span class="co">#&gt; 1 EPSG:32755</span></span>
<span><span class="co">#&gt; 2 EPSG:32620</span></span>
<span><span class="co">#&gt; 3 EPSG:32661</span></span>
<span><span class="co">#&gt; 4 EPSG:32638</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="geodesic-calculations">Geodesic Calculations<a class="anchor" aria-label="anchor" href="#geodesic-calculations"></a>
</h2>
<p>Solve geodesic problems on the WGS84 ellipsoid with full double-precision accuracy.</p>
<div class="section level3">
<h3 id="direct-problem">Direct problem<a class="anchor" aria-label="anchor" href="#direct-problem"></a>
</h3>
<p>Given a starting point, azimuth (bearing), and distance, find the destination:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Where do you end up starting from London, heading east for 1000 km?</span></span>
<span><span class="fu"><a href="reference/geodesic_direct.html">geodesic_direct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">51.5</span><span class="op">)</span>, azi <span class="op">=</span> <span class="fl">90</span>, s <span class="op">=</span> <span class="fl">1000000</span><span class="op">)</span></span>
<span><span class="co">#&gt;   lon1 lat1 azi1   s12     lon2     lat2     azi2    m12       M12       M21</span></span>
<span><span class="co">#&gt; 1 -0.1 51.5   90 1e+06 14.12014 50.62607 101.0838 995914 0.9877522 0.9877514</span></span>
<span><span class="co">#&gt;            S12</span></span>
<span><span class="co">#&gt; 1 7.838198e+12</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="inverse-problem">Inverse problem<a class="anchor" aria-label="anchor" href="#inverse-problem"></a>
</h3>
<p>Given two points, find the distance and azimuths between them:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Distance from London to New York</span></span>
<span><span class="fu"><a href="reference/geodesic_direct.html">geodesic_inverse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">51.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">74</span>, <span class="fl">40.7</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   lon1 lat1 lon2 lat2     s12      azi1      azi2     m12       M12       M21</span></span>
<span><span class="co">#&gt; 1 -0.1 51.5  -74 40.7 5587820 -71.62462 -128.7635 4900877 0.6407216 0.6404073</span></span>
<span><span class="co">#&gt;             S12</span></span>
<span><span class="co">#&gt; 1 -4.040644e+13</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="geodesic-paths">Geodesic paths<a class="anchor" aria-label="anchor" href="#geodesic-paths"></a>
</h3>
<p>Generate points along the shortest path (geodesic) between two points:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Great circle path from London to New York</span></span>
<span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/geodesic_direct.html">geodesic_path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">51.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">74</span>, <span class="fl">40.7</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">path</span></span>
<span><span class="co">#&gt;           lon      lat        azi         s</span></span>
<span><span class="co">#&gt; 1   -0.100000 51.50000  -71.62462       0.0</span></span>
<span><span class="co">#&gt; 2   -8.884387 52.93855  -78.57312  620868.8</span></span>
<span><span class="co">#&gt; 3  -18.121882 53.69011  -85.98680 1241737.7</span></span>
<span><span class="co">#&gt; 4  -27.529365 53.71152  -93.57462 1862606.5</span></span>
<span><span class="co">#&gt; 5  -36.785150 53.00151 -101.00705 2483475.3</span></span>
<span><span class="co">#&gt; 6  -45.602073 51.60102 -107.98901 3104344.2</span></span>
<span><span class="co">#&gt; 7  -53.782959 49.58257 -114.31523 3725213.0</span></span>
<span><span class="co">#&gt; 8  -61.236199 47.03438 -119.88570 4346081.8</span></span>
<span><span class="co">#&gt; 9  -67.957770 44.04615 -124.68751 4966950.7</span></span>
<span><span class="co">#&gt; 10 -74.000000 40.70000 -128.76352 5587819.5</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="distance-matrix">Distance matrix<a class="anchor" aria-label="anchor" href="#distance-matrix"></a>
</h3>
<p>Compute distances between sets of points:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span></span>
<span>  lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="op">-</span><span class="fl">74</span>, <span class="fl">139.7</span>, <span class="fl">151.2</span><span class="op">)</span>,  <span class="co"># London, NYC, Tokyo, Sydney</span></span>
<span>  lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">51.5</span>, <span class="fl">40.7</span>, <span class="fl">35.7</span>, <span class="op">-</span><span class="fl">33.9</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Distance matrix in kilometers</span></span>
<span><span class="fu"><a href="reference/geodesic_direct.html">geodesic_distance_matrix</a></span><span class="op">(</span><span class="va">cities</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1000</span></span>
<span><span class="co">#&gt;           [,1]     [,2]      [,3]      [,4]</span></span>
<span><span class="co">#&gt; [1,]     0.000  5587.82  9581.233 16990.084</span></span>
<span><span class="co">#&gt; [2,]  5587.820     0.00 10872.923 15990.627</span></span>
<span><span class="co">#&gt; [3,]  9581.233 10872.92     0.000  7797.237</span></span>
<span><span class="co">#&gt; [4,] 16990.084 15990.63  7797.237     0.000</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="polygon-area---geodesic-area-and-perimeter">Polygon Area - Geodesic area and perimeter<a class="anchor" aria-label="anchor" href="#polygon-area---geodesic-area-and-perimeter"></a>
</h2>
<p>Compute accurate polygon area and perimeter on the WGS84 ellipsoid:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Triangle: London - New York - Rio de Janeiro</span></span>
<span><span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span></span>
<span>  lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">74</span>, <span class="op">-</span><span class="fl">43</span><span class="op">)</span>,</span>
<span>  lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">52</span>, <span class="fl">41</span>, <span class="op">-</span><span class="fl">23</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/polygon_area.html">polygon_area</a></span><span class="op">(</span><span class="va">pts</span><span class="op">)</span></span>
<span><span class="co">#&gt; $area</span></span>
<span><span class="co">#&gt; [1] 2.653936e+13</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $perimeter</span></span>
<span><span class="co">#&gt; [1] 22634340</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n</span></span>
<span><span class="co">#&gt; [1] 3</span></span></code></pre></div>
<p>The area is returned in square meters and the perimeter in meters. The area is signed: positive for counter-clockwise polygons, negative for clockwise.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Area in square kilometers</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/polygon_area.html">polygon_area</a></span><span class="op">(</span><span class="va">pts</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">area</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1e6</span></span>
<span><span class="co">#&gt; [1] 26539358</span></span></code></pre></div>
<div class="section level3">
<h3 id="multiple-polygons">Multiple polygons<a class="anchor" aria-label="anchor" href="#multiple-polygons"></a>
</h3>
<p>Use the <code>id</code> argument to compute area for multiple polygons at once:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span></span>
<span>  lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">74</span>, <span class="op">-</span><span class="fl">43</span>, <span class="fl">100</span>, <span class="fl">110</span>, <span class="fl">105</span>, <span class="fl">120</span><span class="op">)</span>,</span>
<span>  lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">52</span>, <span class="fl">41</span>, <span class="op">-</span><span class="fl">23</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">15</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/polygon_area.html">polygon_area</a></span><span class="op">(</span><span class="va">pts</span>, id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id          area perimeter n</span></span>
<span><span class="co">#&gt; 1  1  2.653936e+13  22634340 3</span></span>
<span><span class="co">#&gt; 2  2 -4.264720e+11   6253557 4</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="polyline-length">Polyline length<a class="anchor" aria-label="anchor" href="#polyline-length"></a>
</h3>
<p>Set <code>polyline = TRUE</code> to compute the length of a path instead of a closed polygon:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Great circle route length</span></span>
<span><span class="va">route</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span></span>
<span>  lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">151.2</span>, <span class="op">-</span><span class="fl">122.4</span>, <span class="op">-</span><span class="fl">0.1</span><span class="op">)</span>,  <span class="co"># Sydney - San Francisco - London</span></span>
<span></span>
<span>  lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">33.9</span>, <span class="fl">37.8</span>, <span class="fl">51.5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/polygon_area.html">polygon_area</a></span><span class="op">(</span><span class="va">route</span>, polyline <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; $area</span></span>
<span><span class="co">#&gt; [1] 4.659115e-310</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $perimeter</span></span>
<span><span class="co">#&gt; [1] 20577363</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n</span></span>
<span><span class="co">#&gt; [1] 3</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="polar-regions">Polar regions<a class="anchor" aria-label="anchor" href="#polar-regions"></a>
</h3>
<p>Both MGRS and UTM/UPS automatically handle polar regions using UPS:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># North and South pole regions</span></span>
<span><span class="va">polar_pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">147</span>, <span class="fl">148</span>, <span class="op">-</span><span class="fl">100</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">88</span>, <span class="op">-</span><span class="fl">88</span>, <span class="op">-</span><span class="fl">85</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># MGRS in polar regions</span></span>
<span><span class="va">polar_mgrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mgrs_fwd.html">mgrs_fwd</a></span><span class="op">(</span><span class="va">polar_pts</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/mgrs_fwd.html">mgrs_rev</a></span><span class="op">(</span><span class="va">polar_mgrs</span><span class="op">)</span></span>
<span><span class="co">#&gt;         lon lat       x       y zone northp precision convergence     scale</span></span>
<span><span class="co">#&gt; 1  147.0000  88 2120948 2186242    0   TRUE         5    147.0000 0.9943028</span></span>
<span><span class="co">#&gt; 2  148.0001 -88 2117678 1811674    0  FALSE         5   -148.0001 0.9943028</span></span>
<span><span class="co">#&gt; 3 -100.0000 -85 1452982 1903546    0  FALSE         5    100.0000 0.9958948</span></span>
<span><span class="co">#&gt;   grid_zone square_100km        crs</span></span>
<span><span class="co">#&gt; 1         Z           BJ EPSG:32661</span></span>
<span><span class="co">#&gt; 2         B           BL EPSG:32761</span></span>
<span><span class="co">#&gt; 3         A           SM EPSG:32761</span></span>
<span></span>
<span><span class="co"># Direct UTM/UPS conversion</span></span>
<span><span class="fu"><a href="reference/utmups_fwd.html">utmups_fwd</a></span><span class="op">(</span><span class="va">polar_pts</span><span class="op">)</span></span>
<span><span class="co">#&gt;         x       y zone northp convergence     scale  lon lat        crs</span></span>
<span><span class="co">#&gt; 1 2120948 2186243    0   TRUE         147 0.9943028  147  88 EPSG:32661</span></span>
<span><span class="co">#&gt; 2 2117679 1811675    0  FALSE        -148 0.9943028  148 -88 EPSG:32761</span></span>
<span><span class="co">#&gt; 3 1452981 1903546    0  FALSE         100 0.9958948 -100 -85 EPSG:32761</span></span></code></pre></div>
<p>Note that <code>zone = 0</code> indicates UPS projection, with dedicated EPSG codes (32661 for North, 32761 for South).</p>
</div>
<div class="section level3">
<h3 id="performance">Performance<a class="anchor" aria-label="anchor" href="#performance"></a>
</h3>
<p>It’s fast - process tens of thousands of coordinates in milliseconds:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># World cities dataset</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">cbind</span>, <span class="fu">maps</span><span class="fu">::</span><span class="va">world.cities</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"long"</span>, <span class="st">"lat"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#[1] 43645     2</span></span>
<span></span>
<span><span class="co"># MGRS conversion</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">codes</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mgrs_fwd.html">mgrs_fwd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#   user  system elapsed </span></span>
<span><span class="co">#   0.04    0.00    0.04 </span></span>
<span></span>
<span><span class="co"># UTM/UPS conversion</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">utm</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/utmups_fwd.html">utmups_fwd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#   user  system elapsed </span></span>
<span><span class="co">#   0.03    0.00    0.03</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">codes</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co"># [1] "37NCG3952467839" "31PBK7766746791" "36SWD3827984213" "35ULP9426067305" "45VUC7504263576"</span></span>
<span><span class="co"># [6] "36RXV9463390163" "31UFT6135362533" "11SLT9551050534" "32TQQ0915128552" "32PMT1934289062"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">codes</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#[1] 654675</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="comparison-with-other-packages">Comparison with other packages<a class="anchor" aria-label="anchor" href="#comparison-with-other-packages"></a>
</h2>
<p>Several R packages include GeographicLib source code, but none provided the vectorized MGRS, UTM/UPS, and polygon area functionality needed:</p>
<ul>
<li>
<strong>mgrs</strong> - MGRS support but not vectorized, uses older GEOTRANS code</li>
<li>
<strong>geosphere</strong> - Miscellaneous geodetic functions including polygon area (spherical approximation)</li>
<li>
<strong>sf, terra, s2</strong> - Distance and geodetic calculations</li>
<li>
<strong>geodist</strong> - Fast distance calculations</li>
<li>
<strong>nngeo</strong> - Nearest neighbor operations</li>
<li>
<strong>googlePolylines, BH, lwgeom</strong> - Other geodetic utilities</li>
</ul>
</div>
<div class="section level2">
<h2 id="development-notes">Development notes<a class="anchor" aria-label="anchor" href="#development-notes"></a>
</h2>
<ul>
<li>No changes made to GeographicLib source files</li>
<li>Package source code named “000_*_geographiclib.cpp” to differentiate from original sources</li>
<li>See <code>data-raw/GeographicLib.R</code> for source provenance (obtained 2025-06-16 from <a href="https://github.com/geographiclib/geographiclib" class="external-link uri">https://github.com/geographiclib/geographiclib</a> commit 0a6067b)</li>
<li>Note: R CMD check complains about kissfft.hh and src/GeographicLib/Makefile (non-package files from upstream)</li>
</ul>
</div>
<div class="section level2">
<h2 id="code-of-conduct">Code of Conduct<a class="anchor" aria-label="anchor" href="#code-of-conduct"></a>
</h2>
<p>Please note that the geographiclib project is released with a <a href="https://contributor-covenant.org/version/2/1/CODE_OF_CONDUCT.html" class="external-link">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/hypertidy/geographiclib/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/hypertidy/geographiclib/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing geographiclib</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Michael Sumner <br><small class="roles"> Author, maintainer </small>   </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/hypertidy/geographiclib/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/hypertidy/geographiclib/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Michael Sumner.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
