<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Local Coordinates and the Ellipsoid • geographiclib</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Local Coordinates and the Ellipsoid">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">geographiclib</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/geodesics.html">Geodesic Calculations</a>
    </li>
    <li>
      <a href="../articles/geographiclib-overview.html">Introduction to geographiclib</a>
    </li>
    <li>
      <a href="../articles/grid-reference-systems.html">Grid Reference Systems: MGRS, Geohash, GARS, and Georef</a>
    </li>
    <li>
      <a href="../articles/local-coordinates.html">Local Coordinates and the Ellipsoid</a>
    </li>
    <li>
      <a href="../articles/projections.html">Map Projections</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hypertidy/geographiclib/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Local Coordinates and the Ellipsoid</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/hypertidy/geographiclib/blob/main/vignettes/local-coordinates.Rmd" class="external-link"><code>vignettes/local-coordinates.Rmd</code></a></small>
      <div class="hidden name"><code>local-coordinates.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hypertidy/geographiclib" class="external-link">geographiclib</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="contents">Contents<a class="anchor" aria-label="anchor" href="#contents"></a>
</h2>
<ul>
<li><a href="#example-locations">Example Locations</a></li>
<li><a href="#geocentric-ecef-coordinates">Geocentric (ECEF)
Coordinates</a></li>
<li><a href="#local-cartesian-enu-coordinates">Local Cartesian (ENU)
Coordinates</a></li>
<li><a href="#wgs84-ellipsoid-properties">WGS84 Ellipsoid
Properties</a></li>
<li><a href="#combining-coordinate-systems">Combining Coordinate
Systems</a></li>
<li><a href="#coordinate-system-summary">Coordinate System
Summary</a></li>
<li><a href="#see-also">See Also</a></li>
</ul>
</div>
<div class="section level2">
<h2 id="example-locations">Example Locations<a class="anchor" aria-label="anchor" href="#example-locations"></a>
</h2>
<!-- ...existing code... -->
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Locations at various latitudes</span></span>
<span><span class="va">world_pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span></span>
<span>  lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">151.21</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">74.01</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">33.87</span>, <span class="fl">51.51</span>, <span class="fl">40.71</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">90</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">world_pts</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sydney"</span>, <span class="st">"London"</span>, <span class="st">"New York"</span>, <span class="st">"Equator/Prime"</span>, <span class="st">"South Pole"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Antarctic stations</span></span>
<span><span class="va">antarctic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span></span>
<span>  lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">166.67</span>, <span class="fl">77.85</span>, <span class="op">-</span><span class="fl">68.13</span>, <span class="fl">39.58</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">77.85</span>, <span class="op">-</span><span class="fl">67.60</span>, <span class="op">-</span><span class="fl">67.57</span>, <span class="op">-</span><span class="fl">69.41</span>, <span class="op">-</span><span class="fl">90</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">antarctic</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"McMurdo"</span>, <span class="st">"Davis"</span>, <span class="st">"Palmer"</span>, <span class="st">"Progress"</span>, <span class="st">"South Pole"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="geocentric-ecef-coordinates">Geocentric (ECEF) Coordinates<a class="anchor" aria-label="anchor" href="#geocentric-ecef-coordinates"></a>
</h2>
<p>Earth-Centered Earth-Fixed (ECEF) coordinates express positions as X,
Y, Z relative to the Earth’s center:</p>
<ul>
<li>
<strong>X-axis</strong>: Points toward 0°N, 0°E (intersection of
equator and prime meridian)</li>
<li>
<strong>Y-axis</strong>: Points toward 0°N, 90°E (intersection of
equator and 90°E)</li>
<li>
<strong>Z-axis</strong>: Points toward the North Pole</li>
</ul>
<div class="section level3">
<h3 id="basic-conversion">Basic Conversion<a class="anchor" aria-label="anchor" href="#basic-conversion"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/geocentric_fwd.html">geocentric_fwd</a></span><span class="op">(</span><span class="va">world_pts</span><span class="op">)</span></span>
<span><span class="co">#&gt;          X        Y        Z    lon    lat h</span></span>
<span><span class="co">#&gt; 1 -4646017  2553114 -3534483 151.21 -33.87 0</span></span>
<span><span class="co">#&gt; 2  3977778        0  4969055   0.00  51.51 0</span></span>
<span><span class="co">#&gt; 3  1333729 -4654333  4138065 -74.01  40.71 0</span></span>
<span><span class="co">#&gt; 4  6378137        0        0   0.00   0.00 0</span></span>
<span><span class="co">#&gt; 5        0        0 -6356752   0.00 -90.00 0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="understanding-ecef">Understanding ECEF<a class="anchor" aria-label="anchor" href="#understanding-ecef"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Points on the equator have Z ≈ 0</span></span>
<span><span class="va">equator_pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span></span>
<span>  lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">90</span>, <span class="fl">180</span>, <span class="op">-</span><span class="fl">90</span><span class="op">)</span>,</span>
<span>  lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/geocentric_fwd.html">geocentric_fwd</a></span><span class="op">(</span><span class="va">equator_pts</span><span class="op">)</span></span>
<span><span class="co">#&gt;          X        Y Z lon lat h</span></span>
<span><span class="co">#&gt; 1  6378137        0 0   0   0 0</span></span>
<span><span class="co">#&gt; 2        0  6378137 0  90   0 0</span></span>
<span><span class="co">#&gt; 3 -6378137        0 0 180   0 0</span></span>
<span><span class="co">#&gt; 4        0 -6378137 0 -90   0 0</span></span>
<span></span>
<span><span class="co"># Points at poles have X ≈ 0, Y ≈ 0</span></span>
<span><span class="va">pole_pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">90</span>, <span class="op">-</span><span class="fl">90</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/geocentric_fwd.html">geocentric_fwd</a></span><span class="op">(</span><span class="va">pole_pts</span><span class="op">)</span></span>
<span><span class="co">#&gt;   X Y        Z lon lat h</span></span>
<span><span class="co">#&gt; 1 0 0  6356752   0  90 0</span></span>
<span><span class="co">#&gt; 2 0 0 -6356752   0 -90 0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="height-above-ellipsoid">Height Above Ellipsoid<a class="anchor" aria-label="anchor" href="#height-above-ellipsoid"></a>
</h3>
<p>ECEF can include height above the WGS84 ellipsoid:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ground level vs airplane altitude (10km) vs satellite (400km)</span></span>
<span><span class="va">pt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">151.21</span>, <span class="op">-</span><span class="fl">33.87</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  location <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ground"</span>, <span class="st">"Aircraft (10km)"</span>, <span class="st">"ISS (~400km)"</span>, <span class="st">"GPS satellite (~20200km)"</span><span class="op">)</span>,</span>
<span>  h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10000</span>, <span class="fl">400000</span>, <span class="fl">20200000</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/geocentric_fwd.html">geocentric_fwd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">pt</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">pt</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                 h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10000</span>, <span class="fl">400000</span>, <span class="fl">20200000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;                   location        h         X        Y         Z    lon    lat</span></span>
<span><span class="co">#&gt; 1                   Ground        0  -4646017  2553114  -3534483 151.21 -33.87</span></span>
<span><span class="co">#&gt; 2          Aircraft (10km)    10000  -4653294  2557113  -3540056 151.21 -33.87</span></span>
<span><span class="co">#&gt; 3             ISS (~400km)   400000  -4937086  2713064  -3757407 151.21 -33.87</span></span>
<span><span class="co">#&gt; 4 GPS satellite (~20200km) 20200000 -19344970 10630591 -14792154 151.21 -33.87</span></span>
<span><span class="co">#&gt;        h.1</span></span>
<span><span class="co">#&gt; 1        0</span></span>
<span><span class="co">#&gt; 2    10000</span></span>
<span><span class="co">#&gt; 3   400000</span></span>
<span><span class="co">#&gt; 4 20200000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="antarctic-stations-in-ecef">Antarctic Stations in ECEF<a class="anchor" aria-label="anchor" href="#antarctic-stations-in-ecef"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Antarctic stations are all near the "bottom" of the coordinate system</span></span>
<span><span class="fu"><a href="../reference/geocentric_fwd.html">geocentric_fwd</a></span><span class="op">(</span><span class="va">antarctic</span><span class="op">)</span></span>
<span><span class="co">#&gt;            X          Y        Z    lon    lat h</span></span>
<span><span class="co">#&gt; 1 -1310449.4   310501.7 -6213433 166.67 -77.85 0</span></span>
<span><span class="co">#&gt; 2   513025.6  2382902.9 -5874236  77.85 -67.60 0</span></span>
<span><span class="co">#&gt; 3   909126.8 -2264950.0 -5872961 -68.13 -67.57 0</span></span>
<span><span class="co">#&gt; 4  1733893.8  1433382.5 -5948210  39.58 -69.41 0</span></span>
<span><span class="co">#&gt; 5        0.0        0.0 -6356752   0.00 -90.00 0</span></span>
<span></span>
<span><span class="co"># Note the large negative Z values (Southern Hemisphere)</span></span>
<span><span class="co"># and relatively small X, Y values (near the axis)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="round-trip-conversion">Round-trip Conversion<a class="anchor" aria-label="anchor" href="#round-trip-conversion"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fwd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/geocentric_fwd.html">geocentric_fwd</a></span><span class="op">(</span><span class="va">world_pts</span><span class="op">)</span></span>
<span><span class="va">rev</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/geocentric_fwd.html">geocentric_rev</a></span><span class="op">(</span><span class="va">fwd</span><span class="op">$</span><span class="va">X</span>, <span class="va">fwd</span><span class="op">$</span><span class="va">Y</span>, <span class="va">fwd</span><span class="op">$</span><span class="va">Z</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Verify accuracy</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">rev</span><span class="op">$</span><span class="va">lon</span> <span class="op">-</span> <span class="va">world_pts</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">rev</span><span class="op">$</span><span class="va">lat</span> <span class="op">-</span> <span class="va">world_pts</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.421085e-14</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">rev</span><span class="op">$</span><span class="va">h</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Height should be ~0</span></span>
<span><span class="co">#&gt; [1] 1.409644e-09</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="gps-applications">GPS Applications<a class="anchor" aria-label="anchor" href="#gps-applications"></a>
</h3>
<p>ECEF is the native coordinate system for GPS satellites:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Convert GPS receiver position to geodetic</span></span>
<span><span class="co"># (Example: receiver at Sydney at ~100m altitude)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fl">4648241</span>   <span class="co"># meters</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2560342</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">3526276</span></span>
<span></span>
<span><span class="fu"><a href="../reference/geocentric_fwd.html">geocentric_rev</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, <span class="va">Z</span><span class="op">)</span></span>
<span><span class="co">#&gt;         lon       lat         h       X        Y        Z</span></span>
<span><span class="co">#&gt; 1 -28.84683 -33.78127 -55.64177 4648241 -2560342 -3526276</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="local-cartesian-enu-coordinates">Local Cartesian (ENU) Coordinates<a class="anchor" aria-label="anchor" href="#local-cartesian-enu-coordinates"></a>
</h2>
<p>Local Cartesian, also called ENU (East-North-Up), creates a local
coordinate system with:</p>
<ul>
<li>
<strong>East</strong>: Positive X direction</li>
<li>
<strong>North</strong>: Positive Y direction<br>
</li>
<li>
<strong>Up</strong>: Positive Z direction</li>
</ul>
<p>This is ideal for local surveys, robotics, and navigation.</p>
<div class="section level3">
<h3 id="basic-conversion-1">Basic Conversion<a class="anchor" aria-label="anchor" href="#basic-conversion-1"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set up local system centered on Sydney</span></span>
<span><span class="va">sydney</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">151.21</span>, <span class="op">-</span><span class="fl">33.87</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nearby_pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span></span>
<span>  lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">151.21</span>, <span class="fl">151.31</span>, <span class="fl">151.11</span>, <span class="fl">151.21</span>, <span class="fl">151.21</span><span class="op">)</span>,</span>
<span>  lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">33.87</span>, <span class="op">-</span><span class="fl">33.87</span>, <span class="op">-</span><span class="fl">33.87</span>, <span class="op">-</span><span class="fl">33.77</span>, <span class="op">-</span><span class="fl">33.97</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">nearby_pts</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Origin"</span>, <span class="st">"East 10km"</span>, <span class="st">"West 10km"</span>, <span class="st">"North 10km"</span>, <span class="st">"South 10km"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/localcartesian_fwd.html">localcartesian_fwd</a></span><span class="op">(</span><span class="va">nearby_pts</span>, lon0 <span class="op">=</span> <span class="va">sydney</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, lat0 <span class="op">=</span> <span class="va">sydney</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;               x             y         z    lon    lat h</span></span>
<span><span class="co">#&gt; 1  0.000000e+00      0.000000  0.000000 151.21 -33.87 0</span></span>
<span><span class="co">#&gt; 2  9.252524e+03     -4.499921 -6.704168 151.31 -33.87 0</span></span>
<span><span class="co">#&gt; 3 -9.252524e+03     -4.499921 -6.704168 151.11 -33.87 0</span></span>
<span><span class="co">#&gt; 4  5.275069e-11  11091.908279 -9.679492 151.21 -33.77 0</span></span>
<span><span class="co">#&gt; 5 -2.150955e-10 -11092.088563 -9.679702 151.21 -33.97 0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="local-survey-application">Local Survey Application<a class="anchor" aria-label="anchor" href="#local-survey-application"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Survey points around McMurdo Station</span></span>
<span><span class="va">mcmurdo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">166.67</span>, <span class="op">-</span><span class="fl">77.85</span><span class="op">)</span></span>
<span></span>
<span><span class="va">survey_pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span></span>
<span>  lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">166.67</span>, <span class="fl">166.70</span>, <span class="fl">166.64</span>, <span class="fl">166.67</span>, <span class="fl">166.73</span><span class="op">)</span>,</span>
<span>  lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">77.85</span>, <span class="op">-</span><span class="fl">77.85</span>, <span class="op">-</span><span class="fl">77.85</span>, <span class="op">-</span><span class="fl">77.84</span>, <span class="op">-</span><span class="fl">77.86</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">survey_pts</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Base"</span>, <span class="st">"Point A"</span>, <span class="st">"Point B"</span>, <span class="st">"Point C"</span>, <span class="st">"Point D"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/localcartesian_fwd.html">localcartesian_fwd</a></span><span class="op">(</span><span class="va">survey_pts</span>, lon0 <span class="op">=</span> <span class="va">mcmurdo</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, lat0 <span class="op">=</span> <span class="va">mcmurdo</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">result</span></span>
<span><span class="co">#&gt;               x            y          z    lon    lat h</span></span>
<span><span class="co">#&gt; 1  0.000000e+00     0.000000  0.0000000 166.67 -77.85 0</span></span>
<span><span class="co">#&gt; 2  7.051476e+02    -0.180472 -0.0388546 166.70 -77.85 0</span></span>
<span><span class="co">#&gt; 3 -7.051476e+02    -0.180472 -0.0388546 166.64 -77.85 0</span></span>
<span><span class="co">#&gt; 4 -1.907097e-11  1116.439380 -0.0974277 166.67 -77.84 0</span></span>
<span><span class="co">#&gt; 5  1.409152e+03 -1117.161493 -0.2527202 166.73 -77.86 0</span></span>
<span></span>
<span><span class="co"># Distances from base in meters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  point <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">survey_pts</span><span class="op">)</span>,</span>
<span>  east_m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  north_m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>,</span>
<span>  distance_m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">result</span><span class="op">$</span><span class="va">y</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;     point east_m north_m distance_m</span></span>
<span><span class="co">#&gt; 1    Base      0       0          0</span></span>
<span><span class="co">#&gt; 2 Point A    705       0        705</span></span>
<span><span class="co">#&gt; 3 Point B   -705       0        705</span></span>
<span><span class="co">#&gt; 4 Point C      0    1116       1116</span></span>
<span><span class="co">#&gt; 5 Point D   1409   -1117       1798</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="including-height">Including Height<a class="anchor" aria-label="anchor" href="#including-height"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Local system with height differences</span></span>
<span><span class="co"># Simulating a hill near Sydney</span></span>
<span><span class="va">pts_with_height</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span></span>
<span>  lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">151.21</span>, <span class="fl">151.22</span>, <span class="fl">151.20</span><span class="op">)</span>,</span>
<span>  lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">33.87</span>, <span class="op">-</span><span class="fl">33.87</span>, <span class="op">-</span><span class="fl">33.86</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">heights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span>, <span class="fl">100</span><span class="op">)</span>  <span class="co"># meters above ellipsoid</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/localcartesian_fwd.html">localcartesian_fwd</a></span><span class="op">(</span><span class="va">pts_with_height</span>, </span>
<span>                              lon0 <span class="op">=</span> <span class="fl">151.21</span>, lat0 <span class="op">=</span> <span class="op">-</span><span class="fl">33.87</span>, h0 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                              h <span class="op">=</span> <span class="va">heights</span><span class="op">)</span></span>
<span><span class="va">result</span></span>
<span><span class="co">#&gt;           x             y        z    lon    lat   h</span></span>
<span><span class="co">#&gt; 1    0.0000    0.00000000  0.00000 151.21 -33.87   0</span></span>
<span><span class="co">#&gt; 2  925.2601   -0.04499957 49.93296 151.22 -33.87  50</span></span>
<span><span class="co">#&gt; 3 -925.3752 1109.17194197 99.83615 151.20 -33.86 100</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="round-trip-conversion-1">Round-trip Conversion<a class="anchor" aria-label="anchor" href="#round-trip-conversion-1"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span></span>
<span>  lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">166.67</span>, <span class="fl">166.70</span>, <span class="fl">166.64</span><span class="op">)</span>,</span>
<span>  lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">77.85</span>, <span class="op">-</span><span class="fl">77.84</span>, <span class="op">-</span><span class="fl">77.86</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fwd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/localcartesian_fwd.html">localcartesian_fwd</a></span><span class="op">(</span><span class="va">pts</span>, lon0 <span class="op">=</span> <span class="fl">166.67</span>, lat0 <span class="op">=</span> <span class="op">-</span><span class="fl">77.85</span><span class="op">)</span></span>
<span><span class="va">rev</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/localcartesian_fwd.html">localcartesian_rev</a></span><span class="op">(</span><span class="va">fwd</span><span class="op">$</span><span class="va">x</span>, <span class="va">fwd</span><span class="op">$</span><span class="va">y</span>, <span class="va">fwd</span><span class="op">$</span><span class="va">z</span>, lon0 <span class="op">=</span> <span class="fl">166.67</span>, lat0 <span class="op">=</span> <span class="op">-</span><span class="fl">77.85</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">rev</span><span class="op">$</span><span class="va">lon</span> <span class="op">-</span> <span class="va">pts</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">rev</span><span class="op">$</span><span class="va">lat</span> <span class="op">-</span> <span class="va">pts</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="roboticsnavigation-application">Robotics/Navigation Application<a class="anchor" aria-label="anchor" href="#roboticsnavigation-application"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Robot path planning at Davis Station</span></span>
<span><span class="va">davis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">77.85</span>, <span class="op">-</span><span class="fl">67.60</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Waypoints for a robot traverse</span></span>
<span><span class="va">waypoints_enu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Start"</span>, <span class="st">"WP1"</span>, <span class="st">"WP2"</span>, <span class="st">"WP3"</span>, <span class="st">"End"</span><span class="op">)</span>,</span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">250</span>, <span class="fl">300</span><span class="op">)</span>,    <span class="co"># East (meters)</span></span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">150</span><span class="op">)</span>,     <span class="co"># North (meters)</span></span>
<span>  z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>             <span class="co"># Up (meters)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert to geographic coordinates for GPS navigation</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/localcartesian_fwd.html">localcartesian_rev</a></span><span class="op">(</span></span>
<span>  <span class="va">waypoints_enu</span><span class="op">$</span><span class="va">x</span>, <span class="va">waypoints_enu</span><span class="op">$</span><span class="va">y</span>, <span class="va">waypoints_enu</span><span class="op">$</span><span class="va">z</span>,</span>
<span>  lon0 <span class="op">=</span> <span class="va">davis</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, lat0 <span class="op">=</span> <span class="va">davis</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  waypoint <span class="op">=</span> <span class="va">waypoints_enu</span><span class="op">$</span><span class="va">name</span>,</span>
<span>  lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">lon</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>  lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">lat</span>, <span class="fl">6</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   waypoint      lon       lat</span></span>
<span><span class="co">#&gt; 1    Start 77.85000 -67.60000</span></span>
<span><span class="co">#&gt; 2      WP1 77.85235 -67.59955</span></span>
<span><span class="co">#&gt; 3      WP2 77.85470 -67.59910</span></span>
<span><span class="co">#&gt; 4      WP3 77.85588 -67.59910</span></span>
<span><span class="co">#&gt; 5      End 77.85705 -67.59865</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="wgs84-ellipsoid-properties">WGS84 Ellipsoid Properties<a class="anchor" aria-label="anchor" href="#wgs84-ellipsoid-properties"></a>
</h2>
<p>The WGS84 ellipsoid is the reference surface for GPS and most modern
mapping.</p>
<div class="section level3">
<h3 id="basic-parameters">Basic Parameters<a class="anchor" aria-label="anchor" href="#basic-parameters"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ellipsoid_params.html">ellipsoid_params</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $a</span></span>
<span><span class="co">#&gt; [1] 6378137</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $f</span></span>
<span><span class="co">#&gt; [1] 0.003352811</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $b</span></span>
<span><span class="co">#&gt; [1] 6356752</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $e2</span></span>
<span><span class="co">#&gt; [1] 0.00669438</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ep2</span></span>
<span><span class="co">#&gt; [1] 0.006739497</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n</span></span>
<span><span class="co">#&gt; [1] 0.00167922</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $area</span></span>
<span><span class="co">#&gt; [1] 5.100656e+14</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $volume</span></span>
<span><span class="co">#&gt; [1] 1.083207e+21</span></span></code></pre></div>
<p>Key parameters: - <code>a</code>: Semi-major axis (equatorial radius)
≈ 6,378,137 m - <code>b</code>: Semi-minor axis (polar radius) ≈
6,356,752 m - <code>f</code>: Flattening ≈ 1/298.257 - <code>e2</code>:
First eccentricity squared - <code>area</code>: Total surface area -
<code>volume</code>: Total volume</p>
</div>
<div class="section level3">
<h3 id="earths-shape">Earth’s Shape<a class="anchor" aria-label="anchor" href="#earths-shape"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ellipsoid_params.html">ellipsoid_params</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Equatorial vs polar radius difference</span></span>
<span><span class="va">equatorial_radius</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">$</span><span class="va">a</span></span>
<span><span class="va">polar_radius</span> <span class="op">&lt;-</span> <span class="va">params</span><span class="op">$</span><span class="va">b</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Equatorial radius:"</span>, <span class="va">equatorial_radius</span>, <span class="st">"m\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Equatorial radius: 6378137 m</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Polar radius:"</span>, <span class="va">polar_radius</span>, <span class="st">"m\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Polar radius: 6356752 m</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Difference:"</span>, <span class="va">equatorial_radius</span> <span class="op">-</span> <span class="va">polar_radius</span>, <span class="st">"m\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Difference: 21384.69 m</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Flattening:"</span>, <span class="fl">1</span><span class="op">/</span><span class="va">params</span><span class="op">$</span><span class="va">f</span>, <span class="st">"(1/f)\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Flattening: 298.2572 (1/f)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="radii-of-curvature">Radii of Curvature<a class="anchor" aria-label="anchor" href="#radii-of-curvature"></a>
</h3>
<p>The Earth’s curvature varies with latitude:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Curvature at various latitudes</span></span>
<span><span class="va">lats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">33.87</span>, <span class="op">-</span><span class="fl">42.88</span>, <span class="op">-</span><span class="fl">67.60</span>, <span class="op">-</span><span class="fl">77.85</span>, <span class="op">-</span><span class="fl">90</span><span class="op">)</span></span>
<span><span class="va">names_lat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Equator"</span>, <span class="st">"Sydney"</span>, <span class="st">"Hobart"</span>, <span class="st">"Davis"</span>, <span class="st">"McMurdo"</span>, <span class="st">"South Pole"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ellipsoid_params.html">ellipsoid_curvature</a></span><span class="op">(</span><span class="va">lats</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  location <span class="op">=</span> <span class="va">names_lat</span>,</span>
<span>  latitude <span class="op">=</span> <span class="va">lats</span>,</span>
<span>  meridional_km <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">meridional</span> <span class="op">/</span> <span class="fl">1000</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  transverse_km <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">transverse</span> <span class="op">/</span> <span class="fl">1000</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;     location latitude meridional_km transverse_km</span></span>
<span><span class="co">#&gt; 1    Equator     0.00       6335.44       6378.14</span></span>
<span><span class="co">#&gt; 2     Sydney   -33.87       6355.25       6384.78</span></span>
<span><span class="co">#&gt; 3     Hobart   -42.88       6365.01       6388.05</span></span>
<span><span class="co">#&gt; 4      Davis   -67.60       6390.21       6396.46</span></span>
<span><span class="co">#&gt; 5    McMurdo   -77.85       6396.73       6398.64</span></span>
<span><span class="co">#&gt; 6 South Pole   -90.00       6399.59       6399.59</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="circle-of-latitude-properties">Circle of Latitude Properties<a class="anchor" aria-label="anchor" href="#circle-of-latitude-properties"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Properties of circles at different latitudes</span></span>
<span><span class="va">lats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">30</span>, <span class="op">-</span><span class="fl">45</span>, <span class="op">-</span><span class="fl">60</span>, <span class="op">-</span><span class="fl">75</span>, <span class="op">-</span><span class="fl">90</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ellipsoid_params.html">ellipsoid_circle</a></span><span class="op">(</span><span class="va">lats</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  latitude <span class="op">=</span> <span class="va">lats</span>,</span>
<span>  circle_radius_km <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">radius</span> <span class="op">/</span> <span class="fl">1000</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  meridian_dist_km <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">meridian_distance</span> <span class="op">/</span> <span class="fl">1000</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   latitude circle_radius_km meridian_dist_km</span></span>
<span><span class="co">#&gt; 1        0          6378.14             0.00</span></span>
<span><span class="co">#&gt; 2      -30          5528.26         -3320.11</span></span>
<span><span class="co">#&gt; 3      -45          4517.59         -4984.94</span></span>
<span><span class="co">#&gt; 4      -60          3197.10         -6654.07</span></span>
<span><span class="co">#&gt; 5      -75          1655.96         -8326.94</span></span>
<span><span class="co">#&gt; 6      -90             0.00        -10001.97</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="auxiliary-latitudes">Auxiliary Latitudes<a class="anchor" aria-label="anchor" href="#auxiliary-latitudes"></a>
</h3>
<p>For advanced geodetic calculations, various auxiliary latitudes are
used:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare different latitude types at 45°S</span></span>
<span><span class="va">lats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">30</span>, <span class="op">-</span><span class="fl">45</span>, <span class="op">-</span><span class="fl">60</span>, <span class="op">-</span><span class="fl">90</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ellipsoid_params.html">ellipsoid_latitudes</a></span><span class="op">(</span><span class="va">lats</span><span class="op">)</span></span>
<span><span class="va">result</span></span>
<span><span class="co">#&gt;   lat parametric geocentric rectifying  authalic conformal isometric</span></span>
<span><span class="co">#&gt; 1   0    0.00000    0.00000    0.00000   0.00000   0.00000   0.00000</span></span>
<span><span class="co">#&gt; 2 -30  -29.91675  -29.83364  -29.87515 -29.88900 -29.83368 -31.28104</span></span>
<span><span class="co">#&gt; 3 -45  -44.90379  -44.80758  -44.85568 -44.87170 -44.80768 -50.22747</span></span>
<span><span class="co">#&gt; 4 -60  -59.91661  -59.83308  -59.87489 -59.88879 -59.83322 -75.12340</span></span>
<span><span class="co">#&gt; 5 -90  -90.00000  -90.00000  -90.00000 -90.00000 -90.00000      -Inf</span></span>
<span></span>
<span><span class="co"># The differences are small but matter for precise calculations</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="combining-coordinate-systems">Combining Coordinate Systems<a class="anchor" aria-label="anchor" href="#combining-coordinate-systems"></a>
</h2>
<div class="section level3">
<h3 id="gnss-data-processing">GNSS Data Processing<a class="anchor" aria-label="anchor" href="#gnss-data-processing"></a>
</h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Typical GNSS workflow:</span></span>
<span><span class="co"># 1. Receive ECEF coordinates from GPS</span></span>
<span><span class="co"># 2. Convert to geodetic (lat/lon/height)</span></span>
<span><span class="co"># 3. Convert to local for navigation</span></span>
<span></span>
<span><span class="co"># Example GPS receiver data (ECEF, meters)</span></span>
<span><span class="va">gps_ecef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  time <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,</span>
<span>  X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4648241</span>, <span class="fl">4648242</span>, <span class="fl">4648240</span>, <span class="fl">4648243</span>, <span class="fl">4648241</span><span class="op">)</span>,</span>
<span>  Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2560342</span>, <span class="op">-</span><span class="fl">2560340</span>, <span class="op">-</span><span class="fl">2560343</span>, <span class="op">-</span><span class="fl">2560341</span>, <span class="op">-</span><span class="fl">2560342</span><span class="op">)</span>,</span>
<span>  Z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3526276</span>, <span class="op">-</span><span class="fl">3526275</span>, <span class="op">-</span><span class="fl">3526277</span>, <span class="op">-</span><span class="fl">3526274</span>, <span class="op">-</span><span class="fl">3526276</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert to geodetic</span></span>
<span><span class="va">geodetic</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/geocentric_fwd.html">geocentric_rev</a></span><span class="op">(</span><span class="va">gps_ecef</span><span class="op">$</span><span class="va">X</span>, <span class="va">gps_ecef</span><span class="op">$</span><span class="va">Y</span>, <span class="va">gps_ecef</span><span class="op">$</span><span class="va">Z</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert to local (relative to first point)</span></span>
<span><span class="va">local</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/localcartesian_fwd.html">localcartesian_fwd</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">geodetic</span><span class="op">$</span><span class="va">lon</span>, <span class="va">geodetic</span><span class="op">$</span><span class="va">lat</span><span class="op">)</span>,</span>
<span>  lon0 <span class="op">=</span> <span class="va">geodetic</span><span class="op">$</span><span class="va">lon</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, lat0 <span class="op">=</span> <span class="va">geodetic</span><span class="op">$</span><span class="va">lat</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, h0 <span class="op">=</span> <span class="va">geodetic</span><span class="op">$</span><span class="va">h</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  h <span class="op">=</span> <span class="va">geodetic</span><span class="op">$</span><span class="va">h</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  time <span class="op">=</span> <span class="va">gps_ecef</span><span class="op">$</span><span class="va">time</span>,</span>
<span>  east_m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">local</span><span class="op">$</span><span class="va">x</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  north_m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">local</span><span class="op">$</span><span class="va">y</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  up_m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">local</span><span class="op">$</span><span class="va">z</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   time east_m north_m  up_m</span></span>
<span><span class="co">#&gt; 1    1   0.00    0.00  0.00</span></span>
<span><span class="co">#&gt; 2    2   2.23    0.78 -0.63</span></span>
<span><span class="co">#&gt; 3    3  -1.36   -1.05  0.23</span></span>
<span><span class="co">#&gt; 4    4   1.84    2.37 -0.06</span></span>
<span><span class="co">#&gt; 5    5   0.00    0.00  0.00</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="antarctic-field-survey">Antarctic Field Survey<a class="anchor" aria-label="anchor" href="#antarctic-field-survey"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulated survey data at McMurdo</span></span>
<span><span class="va">mcmurdo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">166.67</span>, <span class="op">-</span><span class="fl">77.85</span>, <span class="fl">10</span><span class="op">)</span>  <span class="co"># lon, lat, height</span></span>
<span></span>
<span><span class="co"># Survey points in local coordinates</span></span>
<span><span class="va">survey_local</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  point <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"P1"</span>, <span class="st">"P2"</span>, <span class="st">"P3"</span>, <span class="st">"P4"</span><span class="op">)</span>,</span>
<span>  east <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">500</span>, <span class="op">-</span><span class="fl">300</span>, <span class="fl">200</span>, <span class="op">-</span><span class="fl">100</span><span class="op">)</span>,</span>
<span>  north <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">200</span>, <span class="fl">400</span>, <span class="op">-</span><span class="fl">150</span>, <span class="op">-</span><span class="fl">300</span><span class="op">)</span>,</span>
<span>  up <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="op">-</span><span class="fl">2</span>, <span class="fl">8</span>, <span class="op">-</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert to geodetic for GPS upload</span></span>
<span><span class="va">geodetic</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/localcartesian_fwd.html">localcartesian_rev</a></span><span class="op">(</span></span>
<span>  <span class="va">survey_local</span><span class="op">$</span><span class="va">east</span>, <span class="va">survey_local</span><span class="op">$</span><span class="va">north</span>, <span class="va">survey_local</span><span class="op">$</span><span class="va">up</span>,</span>
<span>  lon0 <span class="op">=</span> <span class="va">mcmurdo</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, lat0 <span class="op">=</span> <span class="va">mcmurdo</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, h0 <span class="op">=</span> <span class="va">mcmurdo</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert to ECEF for satellite positioning</span></span>
<span><span class="va">ecef</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/geocentric_fwd.html">geocentric_fwd</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">geodetic</span><span class="op">$</span><span class="va">lon</span>, <span class="va">geodetic</span><span class="op">$</span><span class="va">lat</span><span class="op">)</span>,</span>
<span>  h <span class="op">=</span> <span class="va">geodetic</span><span class="op">$</span><span class="va">h</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  point <span class="op">=</span> <span class="va">survey_local</span><span class="op">$</span><span class="va">point</span>,</span>
<span>  lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">geodetic</span><span class="op">$</span><span class="va">lon</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">geodetic</span><span class="op">$</span><span class="va">lat</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ecef</span><span class="op">$</span><span class="va">X</span><span class="op">)</span>,</span>
<span>  Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ecef</span><span class="op">$</span><span class="va">Y</span><span class="op">)</span>,</span>
<span>  Z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ecef</span><span class="op">$</span><span class="va">Z</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;     point      lon       lat        X      Y        Z</span></span>
<span><span class="co">#&gt; 1 Control 166.6700 -77.85000 -1310451 310502 -6213443</span></span>
<span><span class="co">#&gt; 2      P1 166.6913 -77.84821 -1310758 310061 -6213406</span></span>
<span><span class="co">#&gt; 3      P2 166.6572 -77.84642 -1310762 310884 -6213357</span></span>
<span><span class="co">#&gt; 4      P3 166.6785 -77.85134 -1310357 310274 -6213482</span></span>
<span><span class="co">#&gt; 5      P4 166.6657 -77.85269 -1310142 310532 -6213501</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="coordinate-system-summary">Coordinate System Summary<a class="anchor" aria-label="anchor" href="#coordinate-system-summary"></a>
</h2>
<table class="table">
<colgroup>
<col width="25%">
<col width="41%">
<col width="32%">
</colgroup>
<thead><tr class="header">
<th>System</th>
<th>Description</th>
<th>Use Case</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Geodetic (lon/lat/h)</td>
<td>Geographic coordinates</td>
<td>Maps, GIS, human communication</td>
</tr>
<tr class="even">
<td>ECEF (X/Y/Z)</td>
<td>Earth-centered Cartesian</td>
<td>GPS satellites, orbit calculations</td>
</tr>
<tr class="odd">
<td>ENU (E/N/U)</td>
<td>Local tangent plane</td>
<td>Robotics, local surveys, navigation</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="see-also">See Also<a class="anchor" aria-label="anchor" href="#see-also"></a>
</h2>
<ul>
<li>
<code><a href="../articles/projections.html">vignette("projections")</a></code> for map projections</li>
<li>
<code><a href="../articles/geodesics.html">vignette("geodesics")</a></code> for distance and bearing
calculations</li>
<li><a href="https://en.wikipedia.org/wiki/Earth-centered,_Earth-fixed_coordinate_system" class="external-link">ECEF
on Wikipedia</a></li>
<li><a href="https://en.wikipedia.org/wiki/Local_tangent_plane_coordinates" class="external-link">Local
tangent plane coordinates</a></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Michael Sumner.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
