<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to geographiclib â€¢ geographiclib</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to geographiclib">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">geographiclib</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/geodesics.html">Geodesic Calculations</a>
    </li>
    <li>
      <a href="../articles/geographiclib-overview.html">Introduction to geographiclib</a>
    </li>
    <li>
      <a href="../articles/grid-reference-systems.html">Grid Reference Systems: MGRS, Geohash, GARS, and Georef</a>
    </li>
    <li>
      <a href="../articles/local-coordinates.html">Local Coordinates and the Ellipsoid</a>
    </li>
    <li>
      <a href="../articles/projections.html">Map Projections</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hypertidy/geographiclib/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to geographiclib</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/hypertidy/geographiclib/blob/main/vignettes/geographiclib-overview.Rmd" class="external-link"><code>vignettes/geographiclib-overview.Rmd</code></a></small>
      <div class="hidden name"><code>geographiclib-overview.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hypertidy/geographiclib" class="external-link">geographiclib</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="contents">Contents<a class="anchor" aria-label="anchor" href="#contents"></a>
</h2>
<ul>
<li><a href="#mgrs---military-grid-reference-system">MGRS - Military
Grid Reference System</a></li>
<li><a href="#utmups---universal-transverse-mercator">UTM/UPS -
Universal Transverse Mercator</a></li>
<li><a href="#geohash">Geohash</a></li>
<li><a href="#gars---global-area-reference-system">GARS - Global Area
Reference System</a></li>
<li><a href="#georef---world-geographic-reference-system">Georef - World
Geographic Reference System</a></li>
<li><a href="#lambert-conformal-conic-projection">Lambert Conformal
Conic Projection</a></li>
<li><a href="#azimuthal-equidistant-projection">Azimuthal Equidistant
Projection</a></li>
<li><a href="#cassini-soldner-projection">Cassini-Soldner
Projection</a></li>
<li><a href="#gnomonic-projection">Gnomonic Projection</a></li>
<li><a href="#osgb---ordnance-survey-national-grid">OSGB - Ordnance
Survey National Grid</a></li>
<li><a href="#local-cartesian-enu-coordinates">Local Cartesian (ENU)
Coordinates</a></li>
<li><a href="#geocentric-ecef-coordinates">Geocentric (ECEF)
Coordinates</a></li>
<li><a href="#wgs84-ellipsoid">WGS84 Ellipsoid</a></li>
<li><a href="#geodesic-calculations">Geodesic Calculations</a></li>
<li><a href="#rhumb-lines-loxodromes">Rhumb Lines (Loxodromes)</a></li>
<li><a href="#polygon-area">Polygon Area</a></li>
<li><a href="#polar-regions">Polar Regions</a></li>
<li><a href="#performance">Performance</a></li>
<li><a href="#further-reading">Further Reading</a></li>
</ul>
</div>
<div class="section level2">
<h2 id="mgrs---military-grid-reference-system-package-provides-r-bindings-to-the">MGRS - Military Grid Reference System package provides R bindings to
the<a class="anchor" aria-label="anchor" href="#mgrs---military-grid-reference-system-package-provides-r-bindings-to-the"></a>
</h2>
<p><a href="https://geographiclib.sourceforge.io/" class="external-link">GeographicLib</a> C++
library for precise geodetic calculations. All functions are fully
vectorized and return rich metadata.</p>
</div>
<div class="section level2">
<h2 id="mgrs---military-grid-reference-system">MGRS - Military Grid Reference System<a class="anchor" aria-label="anchor" href="#mgrs---military-grid-reference-system"></a>
</h2>
<p>Convert geographic coordinates to MGRS codes and back:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Forward conversion</span></span>
<span><span class="op">(</span><span class="va">code</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mgrs_fwd.html">mgrs_fwd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">147.325</span>, <span class="op">-</span><span class="fl">42.881</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "55GEN2654152348"</span></span>
<span></span>
<span><span class="co"># Reverse returns rich metadata</span></span>
<span><span class="fu"><a href="../reference/mgrs_fwd.html">mgrs_rev</a></span><span class="op">(</span><span class="va">code</span><span class="op">)</span></span>
<span><span class="co">#&gt;       lon     lat        x       y zone northp precision convergence     scale</span></span>
<span><span class="co">#&gt; 1 147.325 -42.881 526541.5 5252348   55  FALSE         5  -0.2211584 0.9996087</span></span>
<span><span class="co">#&gt;   grid_zone square_100km        crs</span></span>
<span><span class="co">#&gt; 1       55G           EN EPSG:32755</span></span></code></pre></div>
<p>Variable precision from 100km (0) to 1m (5):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mgrs_fwd.html">mgrs_fwd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">147.325</span>, <span class="op">-</span><span class="fl">42.881</span><span class="op">)</span>, precision <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "55GEN"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="utmups---universal-transverse-mercator">UTM/UPS - Universal Transverse Mercator<a class="anchor" aria-label="anchor" href="#utmups---universal-transverse-mercator"></a>
</h2>
<p>Direct access to UTM projections with automatic zone selection:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">147.325</span>, <span class="op">-</span><span class="fl">74.006</span>, <span class="fl">0</span><span class="op">)</span>, lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">42.881</span>, <span class="fl">40.7128</span>, <span class="fl">88</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/utmups_fwd.html">utmups_fwd</a></span><span class="op">(</span><span class="va">pts</span><span class="op">)</span></span>
<span><span class="co">#&gt;           x       y zone northp convergence     scale     lon      lat</span></span>
<span><span class="co">#&gt; 1  526541.3 5252349   55  FALSE  -0.2211566 0.9996087 147.325 -42.8810</span></span>
<span><span class="co">#&gt; 2  583959.4 4507351   18   TRUE   0.6483920 0.9996868 -74.006  40.7128</span></span>
<span><span class="co">#&gt; 3 2000000.0 1777931    0   TRUE   0.0000000 0.9943028   0.000  88.0000</span></span>
<span><span class="co">#&gt;          crs</span></span>
<span><span class="co">#&gt; 1 EPSG:32755</span></span>
<span><span class="co">#&gt; 2 EPSG:32618</span></span>
<span><span class="co">#&gt; 3 EPSG:32661</span></span></code></pre></div>
<p>Reverse conversion requires zone and hemisphere:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">utm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/utmups_fwd.html">utmups_fwd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">147.325</span>, <span class="op">-</span><span class="fl">42.881</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/utmups_fwd.html">utmups_rev</a></span><span class="op">(</span><span class="va">utm</span><span class="op">$</span><span class="va">x</span>, <span class="va">utm</span><span class="op">$</span><span class="va">y</span>, <span class="va">utm</span><span class="op">$</span><span class="va">zone</span>, <span class="va">utm</span><span class="op">$</span><span class="va">northp</span><span class="op">)</span></span>
<span><span class="co">#&gt;       lon     lat        x       y zone northp convergence     scale        crs</span></span>
<span><span class="co">#&gt; 1 147.325 -42.881 526541.3 5252349   55  FALSE  -0.2211566 0.9996087 EPSG:32755</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="geohash">Geohash<a class="anchor" aria-label="anchor" href="#geohash"></a>
</h2>
<p>Encode locations as compact strings with hierarchical precision:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Default length 12 (~19mm precision)</span></span>
<span><span class="op">(</span><span class="va">gh</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/geohash_fwd.html">geohash_fwd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">147.325</span>, <span class="op">-</span><span class="fl">42.881</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "r22u03yb164p"</span></span>
<span></span>
<span><span class="co"># Truncation preserves containment</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">gh</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "r22u"</span></span>
<span></span>
<span><span class="co"># Reverse shows resolution</span></span>
<span><span class="fu"><a href="../reference/geohash_fwd.html">geohash_rev</a></span><span class="op">(</span><span class="va">gh</span><span class="op">)</span></span>
<span><span class="co">#&gt;       lon     lat len lat_resolution lon_resolution</span></span>
<span><span class="co">#&gt; 1 147.325 -42.881  12   1.676381e-07   3.352761e-07</span></span></code></pre></div>
<p>Resolution table for different lengths:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/geohash_fwd.html">geohash_resolution</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">8</span>, <span class="fl">10</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   len lat_resolution lon_resolution</span></span>
<span><span class="co">#&gt; 1   4   1.757812e-01   3.515625e-01</span></span>
<span><span class="co">#&gt; 2   6   5.493164e-03   1.098633e-02</span></span>
<span><span class="co">#&gt; 3   8   1.716614e-04   3.433228e-04</span></span>
<span><span class="co">#&gt; 4  10   5.364418e-06   1.072884e-05</span></span>
<span><span class="co">#&gt; 5  12   1.676381e-07   3.352761e-07</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="gars---global-area-reference-system">GARS - Global Area Reference System<a class="anchor" aria-label="anchor" href="#gars---global-area-reference-system"></a>
</h2>
<p>Military grid system with 3 precision levels:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gars_fwd.html">gars_fwd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">74</span>, <span class="fl">40.7</span><span class="op">)</span>, precision <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "213LX"</span></span>
<span><span class="fu"><a href="../reference/gars_fwd.html">gars_fwd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">74</span>, <span class="fl">40.7</span><span class="op">)</span>, precision <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "213LX3"</span></span>
<span><span class="fu"><a href="../reference/gars_fwd.html">gars_fwd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">74</span>, <span class="fl">40.7</span><span class="op">)</span>, precision <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "213LX31"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/gars_fwd.html">gars_rev</a></span><span class="op">(</span><span class="st">"213LR29"</span><span class="op">)</span></span>
<span><span class="co">#&gt;         lon      lat precision lat_resolution lon_resolution</span></span>
<span><span class="co">#&gt; 1 -73.54167 37.79167         2     0.08333333     0.08333333</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="georef---world-geographic-reference-system">Georef - World Geographic Reference System<a class="anchor" aria-label="anchor" href="#georef---world-geographic-reference-system"></a>
</h2>
<p>Aviation-oriented grid system:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/georef_fwd.html">georef_fwd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">51.5</span><span class="op">)</span>, precision <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "MKQG"</span></span>
<span><span class="fu"><a href="../reference/georef_fwd.html">georef_fwd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">51.5</span><span class="op">)</span>, precision <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "MKQG5430"</span></span>
<span><span class="fu"><a href="../reference/georef_fwd.html">georef_fwd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">51.5</span><span class="op">)</span>, precision <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "MKQG5430"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/georef_fwd.html">georef_rev</a></span><span class="op">(</span><span class="st">"GJPJ3230"</span><span class="op">)</span></span>
<span><span class="co">#&gt;         lon      lat precision lat_resolution lon_resolution</span></span>
<span><span class="co">#&gt; 1 -76.45833 38.50833         2    0.001666667    0.001666667</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="lambert-conformal-conic-projection">Lambert Conformal Conic Projection<a class="anchor" aria-label="anchor" href="#lambert-conformal-conic-projection"></a>
</h2>
<p>The LCC projection is widely used for aeronautical charts and
regional coordinate systems:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Single standard parallel (tangent cone)</span></span>
<span><span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">100</span>, <span class="op">-</span><span class="fl">99</span>, <span class="op">-</span><span class="fl">98</span><span class="op">)</span>, lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">41</span>, <span class="fl">42</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/lcc_fwd.html">lcc_fwd</a></span><span class="op">(</span><span class="va">pts</span>, lon0 <span class="op">=</span> <span class="op">-</span><span class="fl">100</span>, stdlat <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span>
<span><span class="co">#&gt;           x        y convergence    scale  lon lat</span></span>
<span><span class="co">#&gt; 1      0.00      0.0   0.0000000 1.000000 -100  40</span></span>
<span><span class="co">#&gt; 2  84146.25 111521.9   0.6427876 1.000152  -99  41</span></span>
<span><span class="co">#&gt; 3 165789.24 224013.2   1.2855752 1.000613  -98  42</span></span>
<span></span>
<span><span class="co"># Two standard parallels (secant cone)</span></span>
<span><span class="fu"><a href="../reference/lcc_fwd.html">lcc_fwd</a></span><span class="op">(</span><span class="va">pts</span>, lon0 <span class="op">=</span> <span class="op">-</span><span class="fl">96</span>, stdlat1 <span class="op">=</span> <span class="fl">33</span>, stdlat2 <span class="op">=</span> <span class="fl">45</span><span class="op">)</span></span>
<span><span class="co">#&gt;           x        y convergence     scale  lon lat</span></span>
<span><span class="co">#&gt; 1 -339643.8 108321.8   -2.521985 0.9946660 -100  40</span></span>
<span><span class="co">#&gt; 2 -251122.5 215464.1   -1.891489 0.9950973  -99  41</span></span>
<span><span class="co">#&gt; 3 -164998.9 323691.8   -1.260993 0.9958400  -98  42</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="azimuthal-equidistant-projection">Azimuthal Equidistant Projection<a class="anchor" aria-label="anchor" href="#azimuthal-equidistant-projection"></a>
</h2>
<p>Project relative to any center point - preserves distances from
center:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">74</span>, <span class="fl">139.7</span>, <span class="fl">151.2</span><span class="op">)</span>, lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40.7</span>, <span class="fl">35.7</span>, <span class="op">-</span><span class="fl">33.9</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/azeq_fwd.html">azeq_fwd</a></span><span class="op">(</span><span class="va">pts</span>, lon0 <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span>, lat0 <span class="op">=</span> <span class="fl">51.5</span><span class="op">)</span></span>
<span><span class="va">result</span></span>
<span><span class="co">#&gt;          x       y       azi     scale   lon   lat lon0 lat0</span></span>
<span><span class="co">#&gt; 1 -5302905 1761511 -128.7635 0.8770643 -74.0  40.7 -0.1 51.5</span></span>
<span><span class="co">#&gt; 2  5029432 8155050  156.2494 0.6652729 139.7  35.7 -0.1 51.5</span></span>
<span><span class="co">#&gt; 3 14783025 8374075  139.2137 0.1711044 151.2 -33.9 -0.1 51.5</span></span>
<span></span>
<span><span class="co"># Distance from London = sqrt(x^2 + y^2)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">result</span><span class="op">$</span><span class="va">y</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1000</span></span>
<span><span class="co">#&gt; [1]  5587.820  9581.233 16990.084</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="cassini-soldner-projection">Cassini-Soldner Projection<a class="anchor" aria-label="anchor" href="#cassini-soldner-projection"></a>
</h2>
<p>Historical projection used for large-scale topographic mapping:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">100</span>, <span class="op">-</span><span class="fl">99</span>, <span class="op">-</span><span class="fl">101</span><span class="op">)</span>, lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">41</span>, <span class="fl">39</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/cassini_fwd.html">cassini_fwd</a></span><span class="op">(</span><span class="va">pts</span>, lon0 <span class="op">=</span> <span class="op">-</span><span class="fl">100</span>, lat0 <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span>
<span><span class="co">#&gt;           x             y      azi        rk  lon lat</span></span>
<span><span class="co">#&gt; 1      0.00  7.069289e-10 90.00000 1.0000000 -100  40</span></span>
<span><span class="co">#&gt; 2  84133.35  1.115260e+05 90.65610 0.9999129  -99  41</span></span>
<span><span class="co">#&gt; 3 -86624.66 -1.105493e+05 89.37064 0.9999076 -101  39</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="gnomonic-projection">Gnomonic Projection<a class="anchor" aria-label="anchor" href="#gnomonic-projection"></a>
</h2>
<p>Geodesics appear as straight lines - useful for great circle route
planning:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Project relative to a center point</span></span>
<span><span class="fu"><a href="../reference/gnomonic_fwd.html">gnomonic_fwd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">74</span>, <span class="fl">2.3</span><span class="op">)</span>, lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40.7</span>, <span class="fl">48.9</span><span class="op">)</span><span class="op">)</span>, lon0 <span class="op">=</span> <span class="op">-</span><span class="fl">37</span>, lat0 <span class="op">=</span> <span class="fl">46</span><span class="op">)</span></span>
<span><span class="co">#&gt;          x         y        azi        rk   lon  lat</span></span>
<span><span class="co">#&gt; 1 -3276316  127487.1 -113.67126 0.8893703 -74.0 40.7</span></span>
<span><span class="co">#&gt; 2  2972069 1123467.3   98.77886 0.8951499   2.3 48.9</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="osgb---ordnance-survey-national-grid">OSGB - Ordnance Survey National Grid<a class="anchor" aria-label="anchor" href="#osgb---ordnance-survey-national-grid"></a>
</h2>
<p>Grid reference system for Great Britain (requires OSGB36 datum
coordinates):</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Convert OSGB36 coordinates to grid</span></span>
<span><span class="va">london</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.127</span>, <span class="fl">51.507</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/osgb_fwd.html">osgb_fwd</a></span><span class="op">(</span><span class="va">london</span><span class="op">)</span></span>
<span><span class="co">#&gt;    easting northing convergence     scale    lon    lat</span></span>
<span><span class="co">#&gt; 1 529972.5 180390.9    1.466171 0.9998087 -0.127 51.507</span></span>
<span></span>
<span><span class="co"># Get alphanumeric grid reference</span></span>
<span><span class="fu"><a href="../reference/osgb_fwd.html">osgb_gridref</a></span><span class="op">(</span><span class="va">london</span>, precision <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>  <span class="co"># 100m precision</span></span>
<span><span class="co">#&gt; [1] "TQ299803"</span></span>
<span></span>
<span><span class="co"># Parse a grid reference</span></span>
<span><span class="fu"><a href="../reference/osgb_fwd.html">osgb_gridref_rev</a></span><span class="op">(</span><span class="st">"TQ308080"</span><span class="op">)</span></span>
<span><span class="co">#&gt;          lon      lat easting northing precision</span></span>
<span><span class="co">#&gt; 1 -0.1407134 50.85658  530850   108050         3</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="local-cartesian-enu-coordinates">Local Cartesian (ENU) Coordinates<a class="anchor" aria-label="anchor" href="#local-cartesian-enu-coordinates"></a>
</h2>
<p>Convert to East-North-Up coordinates relative to a local origin:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set up local system centered on London</span></span>
<span><span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="op">-</span><span class="fl">0.2</span>, <span class="fl">0.0</span><span class="op">)</span>, lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">51.5</span>, <span class="fl">51.6</span>, <span class="fl">51.4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/localcartesian_fwd.html">localcartesian_fwd</a></span><span class="op">(</span><span class="va">pts</span>, lon0 <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span>, lat0 <span class="op">=</span> <span class="fl">51.5</span><span class="op">)</span></span>
<span><span class="co">#&gt;           x         y         z  lon  lat h</span></span>
<span><span class="co">#&gt; 1     0.000      0.00   0.00000 -0.1 51.5 0</span></span>
<span><span class="co">#&gt; 2 -6928.841  11130.61 -13.47326 -0.2 51.6 0</span></span>
<span><span class="co">#&gt; 3  6959.234 -11120.93 -13.48954  0.0 51.4 0</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="geocentric-ecef-coordinates">Geocentric (ECEF) Coordinates<a class="anchor" aria-label="anchor" href="#geocentric-ecef-coordinates"></a>
</h2>
<p>Convert between geodetic and Earth-Centered Earth-Fixed
coordinates:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/geocentric_fwd.html">geocentric_fwd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">51.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;         X         Y       Z  lon  lat h</span></span>
<span><span class="co">#&gt; 1 3978642 -6944.048 4968362 -0.1 51.5 0</span></span>
<span></span>
<span><span class="co"># With height</span></span>
<span><span class="fu"><a href="../reference/geocentric_fwd.html">geocentric_fwd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">51.5</span><span class="op">)</span>, h <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="co">#&gt;         X         Y       Z  lon  lat    h</span></span>
<span><span class="co">#&gt; 1 3979265 -6945.135 4969145 -0.1 51.5 1000</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="wgs84-ellipsoid">WGS84 Ellipsoid<a class="anchor" aria-label="anchor" href="#wgs84-ellipsoid"></a>
</h2>
<p>Access ellipsoid parameters and derived quantities:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ellipsoid_params.html">ellipsoid_params</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $a</span></span>
<span><span class="co">#&gt; [1] 6378137</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $f</span></span>
<span><span class="co">#&gt; [1] 0.003352811</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $b</span></span>
<span><span class="co">#&gt; [1] 6356752</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $e2</span></span>
<span><span class="co">#&gt; [1] 0.00669438</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ep2</span></span>
<span><span class="co">#&gt; [1] 0.006739497</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n</span></span>
<span><span class="co">#&gt; [1] 0.00167922</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $area</span></span>
<span><span class="co">#&gt; [1] 5.100656e+14</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $volume</span></span>
<span><span class="co">#&gt; [1] 1.083207e+21</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ellipsoid_params.html">ellipsoid_curvature</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">45</span>, <span class="fl">90</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   lat meridional transverse</span></span>
<span><span class="co">#&gt; 1   0    6335439    6378137</span></span>
<span><span class="co">#&gt; 2  45    6367382    6388838</span></span>
<span><span class="co">#&gt; 3  90    6399594    6399594</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="geodesic-calculations">Geodesic Calculations<a class="anchor" aria-label="anchor" href="#geodesic-calculations"></a>
</h2>
<p>Solve geodesic problems on the WGS84 ellipsoid.</p>
<div class="section level3">
<h3 id="inverse-problem-distance-and-bearing-between-points">Inverse problem: distance and bearing between points<a class="anchor" aria-label="anchor" href="#inverse-problem-distance-and-bearing-between-points"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># London to New York</span></span>
<span><span class="fu"><a href="../reference/geodesic_direct.html">geodesic_inverse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">51.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">74</span>, <span class="fl">40.7</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   lon1 lat1 lon2 lat2     s12      azi1      azi2     m12       M12       M21</span></span>
<span><span class="co">#&gt; 1 -0.1 51.5  -74 40.7 5587820 -71.62462 -128.7635 4900877 0.6407216 0.6404073</span></span>
<span><span class="co">#&gt;             S12</span></span>
<span><span class="co">#&gt; 1 -4.040644e+13</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="direct-problem-destination-from-start-bearing-and-distance">Direct problem: destination from start, bearing, and distance<a class="anchor" aria-label="anchor" href="#direct-problem-destination-from-start-bearing-and-distance"></a>
</h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1000km east from London</span></span>
<span><span class="fu"><a href="../reference/geodesic_direct.html">geodesic_direct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">51.5</span><span class="op">)</span>, azi <span class="op">=</span> <span class="fl">90</span>, s <span class="op">=</span> <span class="fl">1000000</span><span class="op">)</span></span>
<span><span class="co">#&gt;   lon1 lat1 azi1   s12     lon2     lat2     azi2    m12       M12       M21</span></span>
<span><span class="co">#&gt; 1 -0.1 51.5   90 1e+06 14.12014 50.62607 101.0838 995914 0.9877522 0.9877514</span></span>
<span><span class="co">#&gt;            S12</span></span>
<span><span class="co">#&gt; 1 7.838198e+12</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="geodesic-paths">Geodesic paths<a class="anchor" aria-label="anchor" href="#geodesic-paths"></a>
</h3>
<p>Generate points along the shortest path between two locations:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/geodesic_direct.html">geodesic_path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">51.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">74</span>, <span class="fl">40.7</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">path</span></span>
<span><span class="co">#&gt;         lon      lat        azi       s</span></span>
<span><span class="co">#&gt; 1  -0.10000 51.50000  -71.62462       0</span></span>
<span><span class="co">#&gt; 2 -20.47028 53.76472  -87.88020 1396955</span></span>
<span><span class="co">#&gt; 3 -41.26329 52.38360 -104.56966 2793910</span></span>
<span><span class="co">#&gt; 4 -59.44254 47.71610 -118.56584 4190865</span></span>
<span><span class="co">#&gt; 5 -74.00000 40.70000 -128.76352 5587820</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="distance-matrix">Distance matrix<a class="anchor" aria-label="anchor" href="#distance-matrix"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span></span>
<span>  lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="op">-</span><span class="fl">74</span>, <span class="fl">139.7</span>, <span class="fl">151.2</span><span class="op">)</span>,</span>
<span>  lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">51.5</span>, <span class="fl">40.7</span>, <span class="fl">35.7</span>, <span class="op">-</span><span class="fl">33.9</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">cities</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"London"</span>, <span class="st">"NYC"</span>, <span class="st">"Tokyo"</span>, <span class="st">"Sydney"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Distance matrix in km</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/geodesic_direct.html">geodesic_distance_matrix</a></span><span class="op">(</span><span class="va">cities</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="co">#&gt;       [,1]  [,2]  [,3]  [,4]</span></span>
<span><span class="co">#&gt; [1,]     0  5588  9581 16990</span></span>
<span><span class="co">#&gt; [2,]  5588     0 10873 15991</span></span>
<span><span class="co">#&gt; [3,]  9581 10873     0  7797</span></span>
<span><span class="co">#&gt; [4,] 16990 15991  7797     0</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="rhumb-lines-loxodromes">Rhumb Lines (Loxodromes)<a class="anchor" aria-label="anchor" href="#rhumb-lines-loxodromes"></a>
</h2>
<p>Rhumb lines are paths of constant bearing. They are not the shortest
path (geodesics are), but they maintain a constant compass heading -
useful for navigation.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Rhumb distance vs geodesic: London to New York</span></span>
<span><span class="fu"><a href="../reference/geodesic_direct.html">geodesic_inverse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">51.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">74</span>, <span class="fl">40.7</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">s12</span> <span class="op">/</span> <span class="fl">1000</span>  <span class="co"># km</span></span>
<span><span class="co">#&gt; [1] 5587.82</span></span>
<span><span class="fu"><a href="../reference/rhumb_direct.html">rhumb_inverse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">51.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">74</span>, <span class="fl">40.7</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">s12</span> <span class="op">/</span> <span class="fl">1000</span>     <span class="co"># km (longer!)</span></span>
<span><span class="co">#&gt; [1] 5812.568</span></span>
<span></span>
<span><span class="co"># Generate rhumb line path</span></span>
<span><span class="fu"><a href="../reference/rhumb_direct.html">rhumb_path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">51.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">74</span>, <span class="fl">40.7</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in format.data.frame(if (omit) x[seq_len(n0), , drop = FALSE] else x, :</span></span>
<span><span class="co">#&gt; corrupt data frame: columns will be truncated or padded with NAs</span></span>
<span><span class="co">#&gt;         lon      lat       s     azi12</span></span>
<span><span class="co">#&gt; 1  -0.10000 51.50000       0 -101.9189</span></span>
<span><span class="co">#&gt; 2 -20.00072 48.80191 1453142      &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 3 -38.86061 46.10255 2906284      &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4 -56.82095 43.40192 4359426      &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5 -74.00000 40.70000 5812568      &lt;NA&gt;</span></span></code></pre></div>
<p>Key properties: east-west rhumb lines maintain constant latitude,
north-south rhumb lines maintain constant longitude:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Heading due east maintains latitude</span></span>
<span><span class="fu"><a href="../reference/rhumb_direct.html">rhumb_direct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">45</span><span class="op">)</span>, azi <span class="op">=</span> <span class="fl">90</span>, s <span class="op">=</span> <span class="fl">1000000</span><span class="op">)</span></span>
<span><span class="co">#&gt;   lon1 lat1 azi12   s12     lon2 lat2          S12</span></span>
<span><span class="co">#&gt; 1    0   45    90 1e+06 12.68282   45 6.338984e+12</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="polygon-area">Polygon Area<a class="anchor" aria-label="anchor" href="#polygon-area"></a>
</h2>
<p>Compute accurate polygon area and perimeter on the ellipsoid:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Triangle: London - New York - Sydney</span></span>
<span><span class="va">triangle</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span></span>
<span>  lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="op">-</span><span class="fl">74</span>, <span class="fl">151.2</span><span class="op">)</span>,</span>
<span>  lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">51.5</span>, <span class="fl">40.7</span>, <span class="op">-</span><span class="fl">33.9</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/polygon_area.html">polygon_area</a></span><span class="op">(</span><span class="va">triangle</span><span class="op">)</span></span>
<span><span class="va">result</span></span>
<span><span class="co">#&gt; $area</span></span>
<span><span class="co">#&gt; [1] -1.444896e+14</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $perimeter</span></span>
<span><span class="co">#&gt; [1] 38568531</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $n</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span></span>
<span><span class="co"># Area in millions of kmÂ²</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">area</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1e12</span></span>
<span><span class="co">#&gt; [1] 144.4896</span></span></code></pre></div>
<p>Multiple polygons with the <code>id</code> argument:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span></span>
<span>  lon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">11</span><span class="op">)</span>,</span>
<span>  lat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/polygon_area.html">polygon_area</a></span><span class="op">(</span><span class="va">pts</span>, id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id       area perimeter n</span></span>
<span><span class="co">#&gt; 1  1 6154854787  378793.4 3</span></span>
<span><span class="co">#&gt; 2  2 6154854787  378793.4 3</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="polar-regions">Polar Regions<a class="anchor" aria-label="anchor" href="#polar-regions"></a>
</h2>
<p>All functions handle polar regions automatically using UPS (Universal
Polar Stereographic) when appropriate:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">polar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">180</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">89</span>, <span class="op">-</span><span class="fl">89</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># MGRS uses polar grid zones</span></span>
<span><span class="fu"><a href="../reference/mgrs_fwd.html">mgrs_fwd</a></span><span class="op">(</span><span class="va">polar</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "ZAF0000088973" "BAL0000088973"</span></span>
<span></span>
<span><span class="co"># UTM/UPS shows zone 0 for polar</span></span>
<span><span class="fu"><a href="../reference/utmups_fwd.html">utmups_fwd</a></span><span class="op">(</span><span class="va">polar</span><span class="op">)</span></span>
<span><span class="co">#&gt;       x       y zone northp convergence     scale lon lat        crs</span></span>
<span><span class="co">#&gt; 1 2e+06 1888973    0   TRUE           0 0.9940757   0  89 EPSG:32661</span></span>
<span><span class="co">#&gt; 2 2e+06 1888973    0  FALSE        -180 0.9940757 180 -89 EPSG:32761</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="performance">Performance<a class="anchor" aria-label="anchor" href="#performance"></a>
</h2>
<p>All functions are implemented in C++ and fully vectorized:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 40,000+ points in milliseconds</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">40000</span>, <span class="op">-</span><span class="fl">180</span>, <span class="fl">180</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">40000</span>, <span class="op">-</span><span class="fl">80</span>, <span class="fl">80</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu"><a href="../reference/mgrs_fwd.html">mgrs_fwd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.034   0.001   0.036</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu"><a href="../reference/geohash_fwd.html">geohash_fwd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.013   0.000   0.013</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu"><a href="../reference/geodesic_direct.html">geodesic_distance_matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,<span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.060   0.000   0.059</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="further-reading">Further Reading<a class="anchor" aria-label="anchor" href="#further-reading"></a>
</h2>
<ul>
<li><a href="https://geographiclib.sourceforge.io/" class="external-link">GeographicLib
documentation</a></li>
<li><a href="https://en.wikipedia.org/wiki/Military_Grid_Reference_System" class="external-link">MGRS
on Wikipedia</a></li>
<li><a href="https://en.wikipedia.org/wiki/Geohash" class="external-link">Geohash on
Wikipedia</a></li>
<li><a href="https://en.wikipedia.org/wiki/Geodesics_on_an_ellipsoid" class="external-link">Geodesics
on an ellipsoid</a></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Michael Sumner.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
